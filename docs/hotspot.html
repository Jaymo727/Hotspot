<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Function Reference &#8212; Hotspot 0.9.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/my-styles.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Demo: Transcriptional Patterns in CD4 T Cells" href="CD4_Tutorial.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Hotspot</a>
        <span class="navbar-text navbar-version pull-left"><b>0.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="#">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Tutorials <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="Spatial_Tutorial.html">Demo: Spatial data from Slide-seq</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lineage_Tutorial.html">Demo: Lineage-recorded data from Chan et al, (Nature 2019)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CD4_Tutorial.html">Demo: Transcriptional Patterns in CD4 T Cells</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Function Reference</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="function-reference">
<h1>Function Reference<a class="headerlink" href="#function-reference" title="Permalink to this headline">¶</a></h1>
<p>Where does this stuff get included?</p>
<dl class="class">
<dt id="hotspot.Hotspot">
<em class="property">class </em><code class="descclassname">hotspot.</code><code class="descname">Hotspot</code><span class="sig-paren">(</span><em>counts</em>, <em>model='danb'</em>, <em>latent=None</em>, <em>distances=None</em>, <em>tree=None</em>, <em>umi_counts=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Hotspot object for analysis</p>
<p>Either <cite>latent</cite> or <cite>tree</cite> or <cite>distances</cite> is required.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>counts</strong> (<em>pandas.DataFrame</em>) – Count matrix (shape is genes x cells)</li>
<li><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Specifies the null model to use for gene expression.
Valid choices are:</p>
<blockquote>
<div><ul>
<li>’danb’: Depth-Adjusted Negative Binomial</li>
<li>’bernoulli’: Models probability of detection</li>
<li>’normal’: Depth-Adjusted Normal</li>
<li>’none’: Assumes data has been pre-standardized</li>
</ul>
</div></blockquote>
</li>
<li><strong>latent</strong> (<em>pandas.DataFrame</em><em>, </em><em>optional</em>) – Latent space encoding cell-cell similarities with euclidean
distances.  Shape is (cells x dims)</li>
<li><strong>distances</strong> (<em>pandas.DataFrame</em><em>, </em><em>optional</em>) – Distances encoding cell-cell similarities directly
Shape is (cells x cells)</li>
<li><strong>tree</strong> (<em>ete3.coretype.tree.TreeNode</em>) – Root tree node.  Can be created using ete3.Tree</li>
<li><strong>umi_counts</strong> (<em>pandas.Series</em><em>, </em><em>optional</em>) – Total umi count per cell.  Used as a size factor.
If omitted, the sum over genes in the counts matrix is used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hotspot.Hotspot.create_knn_graph">
<code class="descname">create_knn_graph</code><span class="sig-paren">(</span><em>weighted_graph=False</em>, <em>n_neighbors=30</em>, <em>neighborhood_factor=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.create_knn_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.create_knn_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Create’s the KNN graph and graph weights</p>
<p>The resulting matrices containing the neighbors and weights are
stored in the object at <cite>self.neighbors</cite> and <cite>self.weights</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>weighted_graph</strong> (<em>bool</em>) – Whether or not to create a weighted graph</li>
<li><strong>n_neighbors</strong> (<em>int</em>) – Neighborhood size</li>
<li><strong>neighborhood_factor</strong> (<em>float</em>) – Used when creating a weighted graph.  Sets how quickly weights decay
relative to the distances within the neighborhood.  The weight for
a cell with a distance d will decay as exp(-d/D) where D is the distance
to the <cite>n_neighbors</cite>/<cite>neighborhood_factor</cite>-th neighbor.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hotspot.Hotspot.compute_hotspot">
<code class="descname">compute_hotspot</code><span class="sig-paren">(</span><em>jobs=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.compute_hotspot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.compute_hotspot" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform feature selection using local autocorrelation</p>
<p>In addition to returning output, this also stores the output
in <cite>self.results</cite>.</p>
<p>Alias for <cite>self.compute_autocorrelations</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jobs</strong> (<em>int</em>) – Number of parallel jobs to run</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>results</strong> –<p>A dataframe with four columns:</p>
<blockquote>
<div><ul class="simple">
<li>C: Scaled -1:1 autocorrelation coeficients</li>
<li>Z: Z-score for autocorrelation</li>
<li>Pval:  P-values computed from Z-scores</li>
<li>FDR:  Q-values using the Benjamini-Hochberg procedure</li>
</ul>
</div></blockquote>
<p>Gene ids are in the index</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hotspot.Hotspot.compute_autocorrelations">
<code class="descname">compute_autocorrelations</code><span class="sig-paren">(</span><em>jobs=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.compute_autocorrelations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.compute_autocorrelations" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform feature selection using local autocorrelation</p>
<p>In addition to returning output, this also stores the output
in <cite>self.results</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jobs</strong> (<em>int</em>) – Number of parallel jobs to run</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>results</strong> –<p>A dataframe with four columns:</p>
<blockquote>
<div><ul class="simple">
<li>C: Scaled -1:1 autocorrelation coeficients</li>
<li>Z: Z-score for autocorrelation</li>
<li>Pval:  P-values computed from Z-scores</li>
<li>FDR:  Q-values using the Benjamini-Hochberg procedure</li>
</ul>
</div></blockquote>
<p>Gene ids are in the index</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hotspot.Hotspot.compute_local_correlations">
<code class="descname">compute_local_correlations</code><span class="sig-paren">(</span><em>genes</em>, <em>jobs=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.compute_local_correlations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.compute_local_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>Define gene-gene relationships with pair-wise local correlations</p>
<p>In addition to returning output, this method stores its result
in <cite>self.local_correlation_z</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>genes</strong> (<em>iterable of str</em>) – gene identifies to compute local correlations on
should be a smaller subset of all genes</li>
<li><strong>jobs</strong> (<em>int</em>) – Number of parallel jobs to run</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>local_correlation_z</strong> – local correlation Z-scores between genes
shape is genes x genes</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.Dataframe</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hotspot.Hotspot.create_modules">
<code class="descname">create_modules</code><span class="sig-paren">(</span><em>min_gene_threshold=20</em>, <em>core_only=True</em>, <em>fdr_threshold=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.create_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.create_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Groups genes into modules</p>
<p>In addition to being returned, the results of this method are retained
in the object at <cite>self.modules</cite>.  Additionally, the linkage matrix
(in the same form as that of scipy.cluster.hierarchy.linkage) is saved
in <cite>self.linkage</cite> for plotting or manual clustering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>min_gene_threshold</strong> (<em>int</em>) – Controls how small modules can be.  Increase if there are too many
modules being formed.  Decrease if substructre is not being captured</li>
<li><strong>core_only</strong> (<em>bool</em>) – Whether or not to assign ambiguous genes to a module or leave unassigned</li>
<li><strong>fdr_threshold</strong> (<em>float</em>) – Correlation theshold at which to stop assigning genes to modules</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>modules</strong> – Maps gene to module number.  Unassigned genes are indicated with -1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.Series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hotspot.Hotspot.calculate_module_scores">
<code class="descname">calculate_module_scores</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.calculate_module_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.calculate_module_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Module Scores</p>
<p>In addition to returning its result, this method stores
its output in the object at <cite>self.module_scores</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>module_scores</strong> – Scores for each module for each gene
Dimensions are genes x modules</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hotspot.Hotspot.plot_local_correlations">
<code class="descname">plot_local_correlations</code><span class="sig-paren">(</span><em>mod_cmap='tab10'</em>, <em>vmin=-8</em>, <em>vmax=8</em>, <em>z_cmap='RdBu_r'</em>, <em>yticklabels=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hotspot/hotspot.html#Hotspot.plot_local_correlations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hotspot.Hotspot.plot_local_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a clustergrid of the local correlation values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mod_cmap</strong> (<em>valid matplotlib colormap str</em><em> or </em><em>object</em>) – discrete colormap for module assignments on the left side</li>
<li><strong>vmin</strong> (<em>float</em>) – minimum value for colorscale for Z-scores</li>
<li><strong>vmax</strong> (<em>float</em>) – maximum value for colorscale for Z-scores</li>
<li><strong>z_cmap</strong> (<em>valid matplotlib colormap str</em><em> or </em><em>object</em>) – continuous colormap for correlation Z-scores</li>
<li><strong>yticklabels</strong> (<em>bool</em>) – Whether or not to plot all gene labels
Default is false as there are too many.  However
if using this plot interactively you may with to set
to true so you can zoom in and read gene names</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, David DeTomaso.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>